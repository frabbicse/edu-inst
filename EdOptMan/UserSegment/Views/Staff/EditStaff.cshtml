@using System.Linq
@model UserSegment.Models.StaffEntryModel

@{
    ViewData["Title"] = "Update Staff";
    Layout = "~/Views/Shared/_Layout.cshtml";
    // Safe fallback for departments to avoid SelectList(items: null) exceptions
    var departments = ViewBag.Departments as IEnumerable<object> ?? Enumerable.Empty<object>();
}

<div class="page-header">
    <h1 class="page-title">
        <span>✏️</span> Update Staff Information
    </h1>
    <a href="@Url.Action("Index", "Staff")" class="btn-back">← Back to List</a>
</div>

<div class="container">
    <div class="form-card">
        <h2>📝 Edit Staff Details</h2>

        @using (Html.BeginForm("UpdateStaffInfo", "Staff", FormMethod.Post))
        {
            @Html.AntiForgeryToken()
            @Html.HiddenFor(m => m.Id)

            <div class="form-row">

                <div class="form-group">
                    <label>First Name*</label>
                    @Html.TextBoxFor(m => m.FirstName, new { @class = "form-control", required = "required" })
                </div>

                <div class="form-group">
                    <label>Middle Name</label>
                    @Html.TextBoxFor(m => m.MiddleName, new { @class = "form-control" })
                </div>

                <div class="form-group">
                    <label>Last Name*</label>
                    @Html.TextBoxFor(m => m.LastName, new { @class = "form-control", required = "required" })
                </div>

                <div class="form-group">
                    <label>Date of Birth*</label>
                    @Html.TextBoxFor(m => m.DateOfBirth, "{0:yyyy-MM-dd}", new { type = "date", @class = "form-control", required = "required" })
                </div>

                <div class="form-group">
                    <label>Gender*</label>
                    @Html.DropDownListFor(m => m.Gender,
                        new SelectList(new[] { "Male", "Female", "Other" }, Model.Gender),
                        "Select Gender",
                        new { @class = "form-control", required = "required" })
                </div>

                <div class="form-group">
                    <label>Blood Group</label>
                    @Html.TextBoxFor(m => m.BloodGroup, new { @class = "form-control" })
                </div>

                <div class="form-group">
                    <label>Email*</label>
                    @Html.TextBoxFor(m => m.Email, new { @class = "form-control", type = "email", required = "required" })
                </div>

                <div class="form-group">
                    <label>Phone Number*</label>
                    @Html.TextBoxFor(m => m.PhoneNumber, new { @class = "form-control", required = "required" })
                </div>

                <div class="form-group">
                    <label>Emergency Contact</label>
                    @Html.TextBoxFor(m => m.EmergencyContact, new { @class = "form-control" })
                </div>

                <div class="form-group" style="grid-column:1 / -1;">
                    <label>Address*</label>
                    @Html.TextAreaFor(m => m.Address, 3, 50,
                                    new { @class = "form-control", required = "required" })
                </div>

                <!-- Employment -->
                <div class="form-group">
                    <label>Staff ID*</label>
                    @Html.TextBoxFor(m => m.StaffId, new { @class = "form-control", required = "required" })
                </div>

                <div class="form-group">
                    <label>Join Date*</label>
                    @Html.TextBoxFor(m => m.JoinDate, "{0:yyyy-MM-dd}", new { type = "date", @class = "form-control", required = "required" })
                </div>

                <div class="form-group">
                    <label>Department*</label>
                    @Html.DropDownListFor(m => m.DepartmentId,
                                    new SelectList(departments, "Id", "Name", Model.DepartmentId),
                                    "Select Department",
                                    new { @class = "form-control", required = "required" })
                </div>

                <div class="form-group">
                    <label>Designation*</label>
                    @Html.TextBoxFor(m => m.Designation, new { @class = "form-control", required = "required" })
                </div>

                <div class="form-group">
                    <label>Employment Type*</label>
                    @Html.DropDownListFor(m => m.EmploymentType,
                                    new SelectList(new[] { "Full-Time", "Part-Time", "Contract", "Temporary" }, Model.EmploymentType),
                                    "Select Type",
                                    new { @class = "form-control", required = "required" })
                </div>

                <div class="form-group">
                    <label>Salary*</label>
                    @Html.TextBoxFor(m => m.Salary, new { type = "number", step = "0.01", @class = "form-control", required = "required" })
                </div>

            </div>

            <div style="display:flex; gap:15px; justify-content:flex-end; margin-top:30px;">
                <a href="@Url.Action("Index", "Staff")" class="btn-cancel">Cancel</a>
                <button type="submit" class="btn-primary">💾 Update Staff</button>
            </div>
        }
    </div>
</div>
